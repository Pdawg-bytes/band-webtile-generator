WIP! Old code is in `old-branch`.
